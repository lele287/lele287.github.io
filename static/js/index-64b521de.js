import"./modulepreload-polyfill-3cfb730f.js";function E(e=new Date,t="YYYY-MM-DD HH:mm:ss"){var a=e.getFullYear(),r=("0"+(e.getMonth()+1)).slice(-2),c=("0"+e.getDate()).slice(-2),v=("0"+e.getHours()).slice(-2),p=("0"+e.getMinutes()).slice(-2),y=("0"+e.getSeconds()).slice(-2),g=t.replace("YYYY",a).replace("MM",r).replace("DD",c).replace("HH",v).replace("mm",p).replace("ss",y);return g}function N(e,t){let a,r,c,v,p,y,g=[v,p,y];const w="YMDHms";let s,u,i,d;function b(o){t=o,a=t.format||"HH:mm:ss",r=t.type||"time",c=t.theme||"overturn",v=t.hour||0,p=t.minute||0,y=t.second||0,g=[v,p,y],r=="time"?(i=E(new Date,a),d=i):r=="countdown"&&(s=new Date(new Date(new Date().setFullYear(0,0,0)).setHours(...g)),u=s,i=E(s,a),d=i,a=a.slice(a.length-d.replace(/00:/g,"").length),i=E(s,a),d=i),setTimeout(()=>{m(),k(),r!=="countdown"&&C()})}b(t);let n=[];function m(){n=[],e.innerHTML="",e.removeAttribute("class"),e.classList.add(c);for(let o=0;o<a.length;o++){const l=document.createElement("div");w.indexOf(a[o])!=-1?(l.className="time text",$(l,d[o],i[o],c)):(l.className="fill-text",l.innerHTML=`
            <div class="fill-text">${a[o]}</div>
          `),n.push(l),e.appendChild(l)}}function $(o,l,S,H){H==="default"?o.innerHTML=l:o.innerHTML=`
          <div data-before="${S}" data-after="${l}"></div>
          <div data-before="${S}" data-after="${l}"></div>
          `}function A(o,l,S,H){if(S!==l){if(H==="default")o.innerHTML=l;else if(H==="overturn"){const M=o.children[0];new Array(...o.children).forEach(x=>{x.setAttribute("data-before",S),x.setAttribute("data-after",l)}),M.classList.add("turning"),M.ontransitionend=function(){new Array(...o.children).forEach(x=>{x.setAttribute("data-before",l)}),M.classList.remove("turning")}}}}function B(){r=="time"?(i=d,d=E(new Date,a)):r=="countdown"&&(s=u,u=new Date(s.setSeconds(s.getSeconds()-1)),i=d,d=E(u,a));for(let o=0;o<a.length;o++)if(w.indexOf(a[o])!=-1){const l=n[o];A(l,d[o],i[o],c)}}let D;function k(){console.log("销毁"),clearInterval(D),D=null}function C(){k(),console.log("创建"),D=setInterval(()=>{B()},t.type=="countdown"?1e3:100)}return{start:C,reset:k,setData:b}}function Y(e){const t=getComputedStyle(document.documentElement),a=document.createElement("div"),r=document.createElement("select");r.setAttribute("value",e.type);const c=document.createElement("select");c.setAttribute("value",e.theme);const v=document.createElement("div"),p=document.createElement("button");let y=localStorage.getItem("show")=="true";function g(n){localStorage.setItem("show",n),y=n,p.innerHTML=n?"隐藏":"显示",r.style.display=n?"":"none",c.style.display=n?"":"none",w.style.display=n?"":"none",e.type==="countdown"?(s.style.display=n?"":"none",u.style.display=n?"":"none"):(s.style.display="none",u.style.display="none")}p.onclick=()=>{g(!y)},v.appendChild(p);const w=document.createElement("div");w.innerHTML=`
      <span>背景色</span>
      <input type="color" id="backgroundcolor" value="${h["--backgroundcolor"]||t.getPropertyValue("--backgroundcolor")}">
      <span>背景图</span>
      <input type="text" id="backgroundImage" value="${h.backgroundImage||""}">
      <span>卡片背景色</span>
      <input type="color" id="cardcolor" value="${h["--cardcolor"]||t.getPropertyValue("--cardcolor")}">
      <span>字体颜色</span>
      <input type="color" id="textcolor" value="${h["--textcolor"]||t.getPropertyValue("--textcolor")}">
      <button id="resetStyle">重置样式</button>
    `;const s=document.createElement("div");s.innerHTML=`
      <span>时</span>
      <input type="text" id="hour" style="width: 60px" value="${e.hour}" />
      <span>分</span>
      <input type="text" id="minute" style="width: 60px" value="${e.minute}" />
      <span>秒</span>
      <input type="text" id="second" style="width: 60px" value="${e.second}" />
    `;const u=document.createElement("div");u.innerHTML=`
      <button id="reset">暂定</button>
      <button id="start">继续</button>
    `;const i=[{key:"time",value:"time"},{key:"countdown",value:"countdown"}],d=[{key:"default",value:"default"},{key:"overturn",value:"overturn"}];for(const n of i){const m=document.createElement("option");n.value===e.type&&m.setAttribute("selected","selected"),m.setAttribute("value",n.value),m.innerHTML=n.key,r.appendChild(m)}for(const n of d){const m=document.createElement("option");n.value===e.theme&&m.setAttribute("selected","selected"),m.setAttribute("value",n.value),m.innerHTML=n.key,c.appendChild(m)}r.addEventListener("change",n=>{e.type=n.target.value,b(),L(e),localStorage.setItem("config",JSON.stringify(e))}),c.addEventListener("change",n=>{e.theme=n.target.value,L(e),localStorage.setItem("config",JSON.stringify(e))}),a.appendChild(r),a.appendChild(c);function b(){e.type==="countdown"?(s.style.display="",u.style.display=""):(s.style.display="none",u.style.display="none")}b(),panel.appendChild(v),panel.appendChild(a),panel.appendChild(w),panel.appendChild(s),panel.appendChild(u),g(y),document.getElementById("backgroundcolor").onchange=()=>{I(event,"--backgroundcolor")},document.getElementById("backgroundImage").onchange=()=>{I(event,"backgroundImage")},document.getElementById("cardcolor").onchange=()=>{I(event,"--cardcolor")},document.getElementById("textcolor").onchange=()=>{I(event,"--textcolor")},document.getElementById("resetStyle").onclick=()=>{J()},document.getElementById("hour").onchange=()=>{T(event,"hour")},document.getElementById("minute").onchange=()=>{T(event,"minute")},document.getElementById("second").onchange=()=>{T(event,"second")},document.getElementById("reset").onclick=()=>{F(event)},document.getElementById("start").onclick=()=>{P(event)}}let f={type:"time",format:"HH:mm:ss",theme:"overturn",hour:"0",minute:"15",second:"0"};f=JSON.parse(localStorage.getItem("config"))||f;function T(e,t){f[t]=e.target.value,L(f),localStorage.setItem("config",JSON.stringify(f))}let h=JSON.parse(localStorage.getItem("overallstyle"))||{};function O(e){for(let t in e)I({target:{value:e[t]}},t)}function I(e,t){t==="backgroundImage"?document.querySelector("body").style.backgroundImage=`url(${e.target.value})`:document.styleSheets[0].rules[0].style.setProperty(t,e.target.value),h[t]=e.target.value,localStorage.setItem("overallstyle",JSON.stringify(h))}function J(e){localStorage.clear(),location.reload()}O(h);Y(f);const{start:P,reset:F,setData:L}=N(main,f);
