import"./modulepreload-polyfill-3cfb730f.js";let e,i,d=[],s="";const c=document.getElementById("start-button"),o=document.getElementById("pause-button"),n=document.getElementById("resume-button"),l=document.getElementById("stop-button"),u=document.getElementById("download-button"),b=document.getElementById("text"),r=document.getElementById("preview"),a=document.getElementById("playback");o.setAttribute("disabled","disabled");n.setAttribute("disabled","disabled");l.setAttribute("disabled","disabled");u.setAttribute("disabled","disabled");a.style="display: none";b.innerText="实时映射";async function y(){if(!navigator.mediaDevices&&!navigator.mediaDevices.getDisplayMedia){alert("当前浏览器不支持屏幕捕捉");return}v(),i=await navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}),setTimeout(()=>{e=new MediaRecorder(i,{mimeType:"video/webm;codecs=vp9",audioBitsPerSecond:128e3,videoBitsPerSecond:25e7}),e.ondataavailable=function(t){t.data.size>0&&(console.info("视频数据可用",t,e),d.push(t.data))},e.onstop=function(t){m()},e.start(1e3),r.srcObject=i,o.removeAttribute("disabled"),l.removeAttribute("disabled"),c.setAttribute("disabled","disabled"),a.style="display: none",r.style="display: inline-block",b.innerText="实时映射"},300)}function v(){e=null,i=null,d=[]}function f(){n.removeAttribute("disabled"),o.setAttribute("disabled","disabled"),e&&e.state==="recording"&&e.pause()}function g(){o.removeAttribute("disabled"),n.setAttribute("disabled","disabled"),e&&e.state==="paused"&&e.resume()}function m(){if(i)for(let p of i.getTracks())p.stop();if(e&&e.state!=="inactive"&&e.stop(),c.removeAttribute("disabled"),o.setAttribute("disabled","disabled"),n.setAttribute("disabled","disabled"),l.setAttribute("disabled","disabled"),u.removeAttribute("disabled"),r.style="display: none",a.style="display: inline-block",b.innerText="回放",console.log(d),d==null||d.length==0){alert("没有视频数据");return}let t=new Blob(d,{type:"video/webm"});s=URL.createObjectURL(t),a.src=s}function B(){let t=document.createElement("a");document.body.appendChild(t),t.style="display: none",t.href=s,t.download="test.webm",t.click(),window.URL.revokeObjectURL(s)}c.onclick=y;o.onclick=f;n.onclick=g;l.onclick=m;u.onclick=B;
