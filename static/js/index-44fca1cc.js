import"./modulepreload-polyfill-3cfb730f.js";function E(e=new Date,t="YYYY-MM-DD HH:mm:ss"){var a=e.getFullYear(),r=("0"+(e.getMonth()+1)).slice(-2),c=("0"+e.getDate()).slice(-2),v=("0"+e.getHours()).slice(-2),p=("0"+e.getMinutes()).slice(-2),y=("0"+e.getSeconds()).slice(-2),h=t.replace("YYYY",a).replace("MM",r).replace("DD",c).replace("HH",v).replace("mm",p).replace("ss",y);return h}function Y(e,t){let a,r,c,v,p,y,h=[v,p,y];const f="YMDHms";let s,u,d,i;function w(o){t=o,a=t.format||"HH:mm:ss",r=t.type||"time",c=t.theme||"overturn",v=t.hour||0,p=t.minute||0,y=t.second||0,h=[v,p,y],r=="time"?(d=E(new Date,a),i=d):r=="countdown"&&(s=new Date(new Date(new Date().setFullYear(0,0,0)).setHours(...h)),u=s,d=E(s,a),i=d,a=a.slice(a.length-i.replace(/00:/g,"").length),d=E(s,a),i=d),setTimeout(()=>{m(),S(),r!=="countdown"&&C()})}w(t);let n=[];function m(){n=[],e.innerHTML="",e.removeAttribute("class"),e.classList.add(c);for(let o=0;o<a.length;o++){const l=document.createElement("div");f.indexOf(a[o])!=-1?(l.className="time text",$(l,i[o],d[o],c)):(l.className="fill-text",l.innerHTML=`
            <div class="fill-text">${a[o]}</div>
          `),n.push(l),e.appendChild(l)}}function $(o,l,b,I){I==="default"?o.innerHTML=l:o.innerHTML=`
          <div data-before="${b}" data-after="${l}"></div>
          <div data-before="${b}" data-after="${l}"></div>
          `}function A(o,l,b,I){if(b!==l){if(I==="default")o.innerHTML=l;else if(I==="overturn"){const M=o.children[0];new Array(...o.children).forEach(x=>{x.setAttribute("data-before",b),x.setAttribute("data-after",l)}),M.classList.add("turning"),M.ontransitionend=function(){new Array(...o.children).forEach(x=>{x.setAttribute("data-before",l)}),M.classList.remove("turning")}}}}function B(){r=="time"?(d=i,i=E(new Date,a)):r=="countdown"&&(s=u,u=new Date(s.setSeconds(s.getSeconds()-1)),d=i,i=E(u,a));for(let o=0;o<a.length;o++)if(f.indexOf(a[o])!=-1){const l=n[o];A(l,i[o],d[o],c)}}let k;function S(){console.log("销毁"),clearInterval(k),k=null}function C(){S(),console.log("创建"),k=setInterval(()=>{B()},t.type=="countdown"?1e3:100)}return{start:C,reset:S,setData:w}}function N(e){const t=getComputedStyle(document.documentElement),a=document.createElement("div"),r=document.createElement("select");r.setAttribute("value",e.type);const c=document.createElement("select");c.setAttribute("value",e.theme);const v=document.createElement("div"),p=document.createElement("button");let y=localStorage.getItem("show")=="true";function h(n){localStorage.setItem("show",n),y=n,p.innerHTML=n?"隐藏":"显示",r.style.display=n?"":"none",c.style.display=n?"":"none",f.style.display=n?"":"none",e.type==="countdown"?(s.style.display=n?"":"none",u.style.display=n?"":"none"):(s.style.display="none",u.style.display="none")}p.onclick=()=>{h(!y)},v.appendChild(p);const f=document.createElement("div");f.innerHTML=`
      <span>背景色</span>
      <input type="color" id="backgroundcolor" value="${g["--backgroundcolor"]||t.getPropertyValue("--backgroundcolor")}">
      <span>背景图</span>
      <input type="text" id="backgroundImage" value="${g.backgroundImage||""}">
      <span>卡片背景色</span>
      <input type="color" id="cardcolor" value="${g["--cardcolor"]||t.getPropertyValue("--cardcolor")}">
      <span>字体颜色</span>
      <input type="color" id="textcolor" value="${g["--textcolor"]||t.getPropertyValue("--textcolor")}">
      <button id="resetStyle">重置样式</button>
    `;const s=document.createElement("div");s.innerHTML=`
      <span>时</span>
      <input type="text" id="hour" style="width: 60px" value="${e.hour}" />
      <span>分</span>
      <input type="text" id="minute" style="width: 60px" value="${e.minute}" />
      <span>秒</span>
      <input type="text" id="second" style="width: 60px" value="${e.second}" />
    `;const u=document.createElement("div");u.innerHTML=`
      <button id="reset">暂定</button>
      <button id="start">继续</button>
    `;const d=[{key:"time",value:"time"},{key:"countdown",value:"countdown"}],i=[{key:"default",value:"default"},{key:"overturn",value:"overturn"}];for(const n of d){const m=document.createElement("option");n.value===e.type&&m.setAttribute("selected","selected"),m.setAttribute("value",n.value),m.innerHTML=n.key,r.appendChild(m)}for(const n of i){const m=document.createElement("option");n.value===e.theme&&m.setAttribute("selected","selected"),m.setAttribute("value",n.value),m.innerHTML=n.key,c.appendChild(m)}r.addEventListener("change",n=>{e.type=n.target.value,w(),L(e)}),c.addEventListener("change",n=>{e.theme=n.target.value,L(e)}),a.appendChild(r),a.appendChild(c);function w(){e.type==="countdown"?(s.style.display="",u.style.display=""):(s.style.display="none",u.style.display="none")}w(),panel.appendChild(v),panel.appendChild(a),panel.appendChild(f),panel.appendChild(s),panel.appendChild(u),h(y),document.getElementById("backgroundcolor").onchange=()=>{H(event,"--backgroundcolor")},document.getElementById("backgroundImage").onchange=()=>{H(event,"backgroundImage")},document.getElementById("cardcolor").onchange=()=>{H(event,"--cardcolor")},document.getElementById("textcolor").onchange=()=>{H(event,"--textcolor")},document.getElementById("resetStyle").onclick=()=>{O()},document.getElementById("hour").onchange=()=>{T(event,"hour")},document.getElementById("minute").onchange=()=>{T(event,"minute")},document.getElementById("second").onchange=()=>{T(event,"second")},document.getElementById("reset").onclick=()=>{J(event)},document.getElementById("start").onclick=()=>{F(event)}}let D={type:"time",format:"HH:mm:ss",theme:"overturn",hour:"0",minute:"15",second:"0"};function T(e,t){D[t]=e.target.value,L(D)}let g=JSON.parse(localStorage.getItem("overallstyle"))||{};function P(e){for(let t in e)H({target:{value:e[t]}},t)}function H(e,t){t==="backgroundImage"?document.querySelector("body").style.backgroundImage=`url(${e.target.value})`:document.styleSheets[0].rules[0].style.setProperty(t,e.target.value),g[t]=e.target.value,localStorage.setItem("overallstyle",JSON.stringify(g))}function O(e){localStorage.clear(),location.reload()}P(g);N(D);const{start:F,reset:J,setData:L}=Y(main,D);
